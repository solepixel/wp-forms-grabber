var WPFG;String.prototype.format||(String.prototype.format=function(){var t=arguments;return this.replace(/{(\d+)}/g,function(e,i){return"undefined"!=typeof t[i]?t[i]:e})}),function($){WPFG={init:!1,target:"#wp-admin-bar-root-default",counter:0,schemas:!1,schema:!1,form:!1,add_menu:function(t){this.schemas||(this.schemas=JSON.parse(wpfg_vars.schemas)),this.schemas[t.schema]&&(this.schema=this.schemas[t.schema],this.form=t,this.counter++,this.build_form_menu())},build_form_menu:function(){var t=this.create_top_menu(),e="wpfg-"+this.form.schema+"-form-"+this.form.form_id,i=this.get_edit_url(),a=this.get_title(e);if(Object.keys(this.schema).length>1){var r=this.create_sub_menu(e,i,a);t.append(r);for(var s in this.schema){var n=this.schema[s].url.indexOf("{0}")<=-1?this.schema[s].url:this.schema[s].url.format(this.form.form_id),m=this.schema[s].label;r.find("ul").append(this.create_menu_item(e+s,n,m))}}else t.append(this.create_menu_item(e,i,a))},get_title:function(t){return this.form.title?this.form.title:($.ajax({url:wpfg_vars.ajax_url,data:{action:"wpfg_get_title",form_id:this.form.form_id,schema:this.form.schema},type:"get",dataType:"json",success:function(e){e.form_title&&$("#wp-admin-bar-"+t).find("a:first").text(e.form_title)}}),"Edit Form "+this.counter)},get_edit_url:function(){return this.schema.edit&&this.schema.edit.url?this.schema.edit.url.indexOf("{0}")<=-1?this.schema.edit.url:this.schema.edit.url.format(this.form.form_id):"#"},create_top_menu:function(){var t="wpfg",e=$("#wp-admin-bar-"+t+"-default");return e.length?e:($(this.target).append(this.create_sub_menu(t,"#","Edit Forms")),$("#wp-admin-bar-"+t+"-default"))},create_sub_menu:function(t,e,i){var a=$('<li id="wp-admin-bar-'+t+'" class="menupop" />'),r=$('<a class="ab-item" aria-haspopup="true" href="'+e+'" />').html(i),s=$('<div class="ab-sub-wrapper" />'),n=$('<ul id="wp-admin-bar-'+t+'-default" class="ab-submenu" />');return s.append(n),a.append(r),a.append(s),a},create_menu_item:function(t,e,i){var a=$('<li id="wp-admin-bar-'+t+'" />'),r=$('<a class="ab-item" href="'+e+'" />').text(i);return a.append(r),a}},WPFG.init||(WPFG.init=eval(wpfg_vars.init))}(jQuery);